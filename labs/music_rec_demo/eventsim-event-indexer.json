{
  "id" : "eventsim-event-indexer",
  "stages" : [ {
    "type" : "field-mapping",
    "id" : "tkv",
    "mappings" : [ {
      "source" : "/_lw_parser_(.*)/",
      "operation" : "delete"
    }, {
      "source" : "parent",
      "operation" : "delete"
    }, {
      "source" : "_lw_data_source_collection_s",
      "operation" : "delete"
    }, {
      "source" : "_lw_batch_id_s",
      "operation" : "delete"
    }, {
      "source" : "owner",
      "operation" : "delete"
    }, {
      "source" : "group",
      "operation" : "delete"
    }, {
      "source" : "fetchedDate",
      "operation" : "delete"
    }, {
      "source" : "ts",
      "target" : "timestamp_tdt",
      "operation" : "move"
    }, {
      "source" : "userId",
      "target" : "user_id_s",
      "operation" : "move"
    }, {
      "source" : "lastModified",
      "operation" : "delete"
    } ],
    "reservedFieldsMappingAllowed" : true,
    "type" : "field-mapping",
    "skip" : false,
    "secretSourceStageId" : "tkv"
  }, {
    "type" : "javascript-index",
    "id" : "vwm",
    "script" : "function(doc) {\n  var song = doc.getFirstFieldValue(\"song\");\n  var artist = doc.getFirstFieldValue(\"artist\");\n  if (song && artist) {\n doc.setField(\"type_s\",\"click\");\n    doc.setField(\"doc_id_s\", artist+\"-\"+song);\n  }\n  return doc;\n}",
    "type" : "javascript-index",
    "skip" : false,
    "label" : "Create song id",
    "secretSourceStageId" : "vwm"
  }, {
    "type" : "solr-index",
    "id" : "eventsim-event-solr-indexer",
    "enforceSchema" : true,
    "dateFormats" : [ ],
    "params" : [ ],
    "bufferDocsForSolr" : true,
    "type" : "solr-index",
    "skip" : false,
    "label" : "solr-index",
    "secretSourceStageId" : "eventsim-event-solr-indexer"
  } ],
  "properties" : {
    "secretSourcePipelineId" : "eventsim-event-indexer"
  }
}
